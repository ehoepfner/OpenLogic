% Part: first-order-logic
% Chapter: sequent-calculus
% Section: equality

\documentclass[../../../include/open-logic-section]{subfiles}

\begin{document}

\olfileid{fol}{seq}{ide}

\olsection{\usetoken{P}{derivation} with \usetoken{S}{identity}}

!!^{derivation}s with the !!{identity} require additional inference rules.

\paragraph{Initial sequents for $\eq$:}

For any term $t$ $\quad \Sequent \eq[t][t]$ is an initial sequent.

\paragraph{Rules for $\eq$:}

\[
\Axiom$ \Gamma, \eq[t_1][t_2] \fCenter \Delta, \Subst{!A}{t_1}{x}$
\RightLabel{$\eq$}
\UnaryInf$ \Gamma, \eq[t_1][t_2] \fCenter \Delta, \Subst{!A}{t_2}{x}$
\DisplayProof
\quad
\textrm{  and  }
\quad
\Axiom$ \Gamma, \eq[t_1][t_2] \fCenter \Delta, \Subst{!A}{t_2}{x}$
\RightLabel{$\eq$}
\UnaryInf$ \Gamma, \eq[t_1][t_2] \fCenter \Delta, \Subst{!A}{t_1}{x}$
\DisplayProof
\]
where $t_1$ and $t_2$ are terms for $x$ in $!A$.

\begin{ex}
If $s$ and $t$ are terms, then $\Subst{!A}{s}{x}, \eq[s][t] \Proves[\Log{LK}] 
\Subst{!A}{t}{x}$:
\begin{prooftree}
\Axiom$ \Subst{!A}{s}{x} \fCenter \Subst{!A}{s}{x}$
\RightLabel{\LeftR{\Weakening}}
\UnaryInf$ \Subst{!A}{s}{x}, \eq[s][t] \fCenter \Subst{!A}{s}{x}$
\RightLabel{$\eq$}
\UnaryInf$ \Subst{!A}{s}{x}, \eq[s][t] \fCenter \Subst{!A}{t}{x}$
\end{prooftree}
This may be familiar as the principle of substitutability of
identicals or Leibniz' Law.

$\Log{LK}$ proves that $\eq$ is symmetric and transitive:
\[
\Axiom$ \fCenter \eq[t_1][t_1] $
\RightLabel{\LeftR{\Weakening}}
\UnaryInf$ \eq[t_1][t_2] \fCenter \eq[t_1][t_1] $
\RightLabel{$\eq$}
\UnaryInf$ \eq[t_1][t_2] \fCenter \eq[t_2][t_1]$
\DisplayProof
\qquad
\Axiom$ \eq[t_1][t_2] \fCenter \eq[t_1][t_2] $
\RightLabel{\LeftR{\Weakening}}
\UnaryInf$ \eq[t_1][t_2], \eq[t_2][t_3] \fCenter \eq[t_1][t_2] $
\RightLabel{$\eq$}
\UnaryInf$ \eq[t_1][t_2], \eq[t_2][t_3] \fCenter \eq[t_1][t_3]$
\DisplayProof
\]
In the proof on the left, the !!{formula}~$\eq[x][t_1]$ is our $!A$. On the 
right, we take $!A$ to be $\eq[t_1][x]$.
\end{ex}

\begin{prob}
Give !!{derivation}s of the following sequents:
\begin{enumerate}
\item $\Sequent \lforall[x][\lforall[y][((x = y \land !A(x)) \lif !A(y))]]$
\item $\lexists[x][!A(x)] \land \lforall[y][\lforall[z][((!A(y) \land !A(z)) \lif y = z)]] \Sequent {}$\\
\hskip 1em$\lexists[x][(!A(x) \land \lforall[y][(!A(y) \lif y = x)])]$
\end{enumerate}
\end{prob}

\begin{prop}
$\Log{LK}$ with initial sequents and rules for identity is sound.
\end{prop}

\begin{proof}
We extend the proof of \olref[fol][seq][sou]{sequent-soundness}. We have to 
show that $\quad \Sequent t = t$ is valid and, if $\Gamma, \eq[t_1][t_2] 
\Sequent \Delta, \Subst{!A}{t_1}{x}$, then $\Gamma, \eq[t_1][t_2] \Sequent 
\Delta, \Subst{!A}{t _2}{x}$ and vice versa.

An initial sequents of the form $\quad \Sequent \eq[t][t]$ is valid since for every 
$\Struct M$ we have $\Sat{M}{\eq[t][t]}[s]$.

Suppose $\Gamma, \eq[t_1][t_2] \Sequent \Delta, \Subst{!A}{t_1}{x}$ is valid. 
Let $\Struct M$, $s$ with $\Sat{M}{\Gamma \cup \{\eq[t_1][t_2]\}}[s]$ be 
arbitrary. In particular, $\Sat{M}{\eq[t_1][t_2]}[s]$, hence $\Value{t_1}{M}[ 
s ] = \Value{t_2}{M}[s]$. Consider the $x$-variant $s'$ of $s$ given by $s(x) 
= \Value{t_1}{M}[s]$. By \olref[fol][syn][ext]{prop:ext-formulas}, $\Sat{M}{ 
\Subst{!A}{t_1}{x}}[s]$ iff $\Sat{M}{!A}[s']$ iff $\Sat{M}{\Subst{!A}{t_2}{x}}
  [s]$. Because of the premise, we have either $\Sat{M}{!E}[s]$ for some $!E 
\in \Delta$ or $\Sat{M}{\Subst{!A}{t_1}{x}}[s]$, thus $\Sat{M}{\Subst{!A}{t_2 
}{x}}[s]$. Consequently, $\Gamma, \eq[t_1][t_2] \Sequent \Delta, \Subst{!A}{t 
_2}{x}$ is valid as well. 
\end{proof}

\end{document}
